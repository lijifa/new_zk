<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="utf-8">
	<title>HuaDeGuangHeGu</title>
	<style>
		html {
			box-sizing: border-box;
		}

		*,
		*:before,
		*:after {
			box-sizing: inherit;
		}

		body {
			margin: 0;
			/* background: #444; */
		}

		#gameContainer {
			width: 100vw;
			height: 100vh;
		}

		canvas {
			width: 100%;
			height: 100%;
			display: block;
		}

		.logo {
			display: block;
			width: 100vw;
			height: 100vh;
		}

		.progress {
			margin: 1.5em;
			border: 1px solid #02a7fe;
			width: 30vw;
			display: none;
			position: absolute;
			bottom: 50%;
			left: 50%;
			margin-left: -15vw;
		}

		.progress .full {
			margin: 2px;
			background: #02a7ce;
			height: 0.1em;
			transform-origin: top left;
		}

		#loader {
			position: absolute;
			left: 0;
			top: 0;
			width: 100vw;
			height: 100vh;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
		}

		.spinner,
		.spinner:after {
			border-radius: 50%;
			width: 5em;
			height: 5em;
		}

		.spinner {
			margin: 10px;
			font-size: 10px;
			position: relative;
			text-indent: -9999em;
			border-top: 1.1em solid rgba(255, 255, 255, 0.2);
			border-right: 1.1em solid rgba(255, 255, 255, 0.2);
			border-bottom: 1.1em solid rgba(255, 255, 255, 0.2);
			border-left: 1.1em solid #ffffff;
			transform: translateZ(0);
			animation: spinner-spin 1.1s infinite linear;
		}

		@keyframes spinner-spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}

		@media screen and (orientation: landscape) and (min-width: 480px) and (max-width: 995px) {
			.progress {
				bottom: 10%;
			}
		}
	</style>
	<script>
		document.write('<script src="../../../common/lib/config.js?time=' + new Date().getTime() + '"><\/script>');
	</script>
	<meta name="viewport"
		content="width=device-width, user-scalable=no, initial-scale=0.5, maximum-scale=0.5, minimum-scale=0.5,minimal-ui">
</head>

<body onload="Reset()" onresize="Reset()" ,scroll=no, style="overflow:hidden">
	<div id="gameContainer" style="width: 100%; height: 100%;margin:auto"></div>
	<div id="loader">
		<img class="logo" src="logo.png" />
		<div class="spinner"></div>
		<div class="progress">
			<div class="full"></div>
		</div>
	</div>

	<div id="#pointer" style="cursor:pointer"></div>
	<div id="#default" style="cursor:default"></div>
	<button Type="button" onclick="JsToUnity()">WebToUnity</button>
</body>
<script src="../../../common/lib/jquery-3.2.1.js"></script>
<script>
	document.write('<script src="Build/UnityLoader.js?v=' + version + '"><\/script>');
	document.write('<script src="../../../common/js/u3dTools.js?v=' + version + '"><\/script\>');
</script>
<script>
	//屏蔽右键菜单
	document.oncontextmenu = function () {
		event.returnValue = false;
		if (parent.bottomBar.param.isOpen) {
			parent.bottomBar.hideMenu();
		} else {
			parent.bottomBar.param.isOpen = false;
			parent.bottomBar.showMenu();
		}
	}
	var u3dObj = new U3DTools('gameContainer', {
		"jsonPath": "Build/Bussiness_BigScene.json",
		"completeCallback": completeCallback
	})
	var gameInstance = u3dObj.createUnity()

	function completeCallback(gameInstance) {
		parent.projectU3D.projectU3Ddata(gameInstance)
		console.log("company回调")
		var objName = parent.layuiId;
		// var objName = 'hdzh-home';
		// var objName = sessionStorage.layuiId;
		window.onunload = function () {
			// top.unregisterListener(objName); //销毁
		}
		gameInstance.SendMessage("SceneMgr", "LoadBigScene", objName);
		// top.registerListener(objName, function(e) {
		// 	console.log("来自公司页面" + e)
		// 	gameInstance.SendMessage("SceneMgr", "LoadBigScene", e);
		// 	Reset();
		// }); //注册
		Reset();
	}
	// var canvas = document.getElementById("#canvas");
	// var pointerDiv = document.getElementById("#pointer");
	// var defaultDiv = document.getElementById("#default");

	// function Reset() {
	// 	var canvas = document.getElementById("#canvas"); //获取#canvas

	// 	canvas.width = window.innerWidth;
	// 	canvas.height = window.innerHeight;

	// 	if (typeof canvas.width != "number") {
	// 		//在标准模式下面
	// 		if (document.compatMode == "CSS1Compat") {
	// 			canvas.width = document.documentElement.clientWidth;
	// 			canvas.height = document.documentElement.clientHeight;
	// 		} else {
	// 			canvas.width = document.body.clientWidth;
	// 			canvas.height = window.body.clientHeight;
	// 		}
	// 	}
	// }
	//JS发送消息给Unity
	function JsToUnity() {
		gameInstance.SendMessage("gameObjName", "JsMessage", "unity你好");
	}

	function showVideo() {
		gameInstance.SendMessage("ItemDetailPanel", "HideDetailPanel");
	}

	function closeVideo() {

	}

	function canmerHide() {

	}

	// function Log(str) {
	// 	console.log(str);
	// }

	function canShowCameraPositionById(str) {
		console.log(str);
	}

	// function UnityProgress(gameInstance, progress) {
	// 	if (!gameInstance.Module) {
	// 		return;
	// 	}
	// 	const loader = document.querySelector("#loader");
	// 	if (!gameInstance.progress) {
	// 		const progress = document.querySelector("#loader .progress");
	// 		progress.style.display = "block";
	// 		gameInstance.progress = progress.querySelector(".full");
	// 		loader.querySelector(".spinner").style.display = "none";
	// 	}
	// 	gameInstance.progress.style.transform = `scaleX(${progress})`;
	// 	if (progress === 1 && !gameInstance.removeTimeout) {
	// 		gameInstance.removeTimeout = setTimeout(function() {
	// 			loader.style.display = "none";
	// 		}, 0);
	// 	}
	// }
	// var topJQ = top.$;

	function DoubleClickJiFangBuild() {
		// 跳转到国际企业社区地热机房页
		// window.GuoJiSite = function() {
		// 	var GuoJiSiteMenuData = topJQ("#menu [data-url^='./bussiness/internationalFirmsU3D/index.html']");
		// 	var dataUrlStr = './bussiness/internationalFirmsU3D/index.html'
		// 	console.log(parent._PROJECT_ID);
		// 	for (var i = 0; i < GuoJiSiteMenuData.length; i++) {
		// 		var url = topJQ(GuoJiSiteMenuData[i]).data("url");
		// 		var id = topJQ(GuoJiSiteMenuData[i]).data("id");
		// 		var title = topJQ(GuoJiSiteMenuData[i]).data("title");
		// 		if (url.indexOf(parent._PROJECT_ID) != -1) {
		// 			top.window.openNewTab(url, id, title);
		// 			// var dataUrlArr.push(top.$('#menu a').attr('data-url')==undefined?undefined:top.$('#menu a').attr('data-url'))
		// 			// console.log(dataUrlArr)
		// 			// var dataUrlIndex=null
		// 			// for(var j=0;j<dataUrlArr.length;j++){
		// 			// 	if(dataUrlArr[j].attr('data-url')!==undefined&&
		// 			// 	dataUrlArr[j].attr('data-url').indexOf(dataUrlStr)!==-1){
		// 			// 		dataUrlIndex=index
		// 			// 	}
		// 			// }
		// 			// dataUrlArr.forEach((item,index)=>{
		// 			// 	if(item.attr('data-url')!==undefined&&item.attr('data-url').indexOf(dataUrlStr)!==-1){
		// 			// 		dataUrlIndex=index
		// 			// 	}
		// 			// })
		// 			// if(dataUrlIndex!==null){
		// 			// 	top.$('#menu a').parent().find('layui-this').removeClass('layui-this')
		// 			// 	top.$('#menu a').eq(dataUrlIndex).parent().addClass('layui-this')
		// 			// }
		// 			// var dataUrl=top.$('#menu a')
		// 			return;
		// 		}
		// 	}

		// 	// alert("当前项目没有机房页面，请联系管理员添加！");
		// 	parent.layui.use('layer', function() {
		// 		var layer = parent.layui.layer;
		// 		layer.msg('当前项目没有机房页面，请联系管理员添加！');
		// 	});
		// 	// console.log(top.$('#menu a'))
		// 	// var dataUrl=top.$('#menu a')
		// 	// console.log(dataUrl)
		// 	// top.window.openNewTab(GuoJiSiteMenuData.data("url"), GuoJiSiteMenuData.data("id"), GuangHeGuSiteMenuData.data("title"));
		// };
		// window.GuoJiSite()

		window.clickJumpTo('/jquery/29');
	}

	function DoubleClickMoDuanBuild() {
		// 跳转到国际企业社区末端页
		// window.MoDuanSite = function() {
		// 	var MoDuanSiteMenuData = topJQ("#menu [data-url^='./bussiness/CBDterminal/index3d.html']");
		// 	console.log(parent._PROJECT_ID);
		// 	for (var i = 0; i < MoDuanSiteMenuData.length; i++) {
		// 		var url = topJQ(MoDuanSiteMenuData[i]).data("url");
		// 		var id = topJQ(MoDuanSiteMenuData[i]).data("id");
		// 		var title = topJQ(MoDuanSiteMenuData[i]).data("title");
		// 		if (url.indexOf(parent._PROJECT_ID) != -1) {
		// 			// console.log(url)
		// 			top.window.openNewTab(url, id, title);
		// 			return;
		// 		}
		// 	}
		// 	// alert("当前项目没有机房页面，请联系管理员添加！");
		// 	parent.layui.use('layer', function() {
		// 		var layer = parent.layui.layer;
		// 		layer.msg('当前项目没有末端页面，请联系管理员添加！');
		// 	});
		// 	console.log(top.$('#menu a'))
		// 	// top.window.openNewTab(MoDuanSiteMenuData.data("url"), MoDuanSiteMenuData.data("id"), GuangHeGuSiteMenuData.data("title"));
		// };
		// window.MoDuanSite()

		window.clickJumpTo('/jquery/92');
	}

	function ShowBussinessJiFangInfoPanel(params) {
		parent.projectU3D.showSitelist(params);
		// console.log('diaoyong')
	}

	function HideBussinessJiFangInfoPanel() {
		parent.projectU3D.hideSitelist();
		// console.log('123141')
	}
	// 控制设置U3d触控
	function UnityStart() {
		console.log('UnityStart');
		if (window.matchMedia("(any-pointer: coarse)").matches) {
			console.log('触摸屏');
			gameInstance.SendMessage("RecvJsMessageObject", 'GetEvent', '15000' + ', ');
		} else {
			console.log('非触摸屏');
		}
		Reset();
	}
</script>

</html>