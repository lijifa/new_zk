<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="utf-8" />
	<meta name="viewport"
		content="width=device-width, user-scalable=no, initial-scale=0.5, maximum-scale=0.5, minimum-scale=0.5,minimal-ui">
	<title>HuaDeGuangHeGu</title>
	<style>
		html {
			box-sizing: border-box;
		}

		*,
		*:before,
		*:after {
			box-sizing: inherit;
		}

		body {
			margin: 0;
			/* background: #444; */
		}

		#gameContainer {
			width: 100vw;
			height: 100vh;
			background: transparent !important;
		}

		canvas {
			width: 100%;
			height: 100%;
			display: block;
		}

		.logo {
			display: block;
			width: 100vw;
			height: 100vh;
		}

		.progress {
			margin: 1.5em;
			border: 1px solid #02a7fe;
			width: 30vw;
			display: none;
			position: absolute;
			bottom: 50%;
			left: 50%;
			margin-left: -15vw;
		}

		.progress .full {
			margin: 2px;
			background: #02a7ce;
			height: 0.1em;
			transform-origin: top left;
		}

		#loader {
			position: absolute;
			left: 0;
			top: 0;
			width: 100vw;
			height: 100vh;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
		}

		.spinner,
		.spinner:after {
			border-radius: 50%;
			width: 5em;
			height: 5em;
		}

		.spinner {
			margin: 10px;
			font-size: 10px;
			position: relative;
			text-indent: -9999em;
			border-top: 1.1em solid rgba(255, 255, 255, 0.2);
			border-right: 1.1em solid rgba(255, 255, 255, 0.2);
			border-bottom: 1.1em solid rgba(255, 255, 255, 0.2);
			border-left: 1.1em solid #ffffff;
			transform: translateZ(0);
			animation: spinner-spin 1.1s infinite linear;
		}

		@keyframes spinner-spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}

		@media screen and (orientation: landscape) and (min-width: 480px) and (max-width: 995px) {
			.progress {
				bottom: 10%;
			}
		}
	</style>
	<script>
		document.write('<script src="/common/lib/config.js?time=' + new Date().getTime() + '"><\/script>');
	</script>
</head>

<body onload="Reset()" onresize="Reset()" ,scroll=no, style="width: 100%; height: 100%;overflow:hidden">
	<div id="gameContainer" style="width: 100%; height: 100%;margin:auto"></div>
	<div id="loader">
		<img class="logo" src="logo.png" />
		<div class="spinner"></div>
		<div class="progress">
			<div class="full"></div>
		</div>
	</div>
</body>
<script src="/common/lib/jquery-3.2.1.js"></script>
<script>
	document.write('<script src="Build/UnityLoader.js?v=' + version + '"><\/script>');
	document.write('<script src="/common/js/u3dTools.js?v=' + version + '"><\/script\>');
</script>
<script>
	//屏蔽右键菜单
	document.oncontextmenu = function () {
		event.returnValue = false;
		if (parent.buttomBar.param.isOpen) {
			parent.buttomBar.hideMenu();
		} else {
			parent.buttomBar.param.isOpen = false;
			parent.buttomBar.showMenu();
		}
	}
	var u3dObj = new U3DTools('gameContainer', {
		// "jsonPath": "Build/Guanghegu_Android.json",
		"jsonPath": "Build/GuangHeGuZongLan.json",
		"completeCallback": completeCallback
	})
	var gameInstance = u3dObj.createUnity()

	// 回调函数
	function completeCallback(gameContainer) {
		parent.project.u3dinit(gameInstance);
		console.log("project-management10回调")

		// var objName = parent.layuiId;
		// window.onunload = function () {
		// 	top.unregisterListener(objName); //销毁
		// }
		// gameInstance.SendMessage("CameraMgr", "SetU3dPageId", objName);
		// top.registerListener(objName, function (e) {
		// 	console.log("来自项目页面" + e)
		// 	gameInstance.SendMessage("CameraMgr", "ControlU3DCamera", e);
		// 	Reset();
		// }); //注册



		Reset();
	}
	var topJQ = top.$;
	// var canvas;
	// $(function () {
	//   var gameInstance = UnityLoader.instantiate("gameContainer", "Build/Build.json", { onProgress: UnityProgress });
	//   function UnityProgress(gameInstance, progress) {
	//     if (!gameInstance.Module) {
	//       return;
	//     }
	//     const loader = document.querySelector("#loader");
	//     if (!gameInstance.progress) {
	//       const progress = document.querySelector("#loader .progress");
	//       progress.style.display = "block";
	//       gameInstance.progress = progress.querySelector(".full");
	//       loader.querySelector(".spinner").style.display = "none";
	//       canvas = document.getElementById("#canvas");
	//     }
	//     gameInstance.progress.style.transform = `scaleX(${progress})`;
	//     if (progress === 1 && !gameInstance.removeTimeout) {
	//       gameInstance.removeTimeout = setTimeout(function () {
	//         loader.style.display = "none";
	// 	parent.project.u3dinit(gameInstance);
	//       }, 0);
	//     }
	//   }
	// });
	// 跳转到光合谷地热机房页
	window.JiFangSite = function () {
		// 调用React方法跳转到机房站点
		top.window.clickJumpTo('/jquery/8');

		// var GuangHeGuSiteMenuData = topJQ("#menu [data-url^='./bussiness/monitoringU3dNew/index.html']");
		// console.log(parent._PROJECT_ID);
		// for (var i = 0; i < GuangHeGuSiteMenuData.length; i++) {
		// 	var url = topJQ(GuangHeGuSiteMenuData[i]).data("url");
		// 	var id = topJQ(GuangHeGuSiteMenuData[i]).data("id");
		// 	var title = topJQ(GuangHeGuSiteMenuData[i]).data("title");
		// 	if (url.indexOf(parent._PROJECT_ID) != -1) {
		// 		top.window.openNewTab(url, id, title);
		// 		return;
		// 	}
		// }
		// // alert("当前项目没有机房页面，请联系管理员添加！");
		// parent.layui.use('layer', function () {
		// 	var layer = parent.layui.layer;
		// 	layer.msg('当前项目没有机房页面，请联系管理员添加！');
		// });

		// top.window.openNewTab(GuangHeGuSiteMenuData.data("url"), GuangHeGuSiteMenuData.data("id"), GuangHeGuSiteMenuData.data("title"));
	};

	// function Log() {}
	//   var pointerDiv = document.getElementById("#pointer");
	//   var defaultDiv = document.getElementById("#default");
	//   //修改鼠标指针为手型
	//   function ChangeMouse2Pointer(arg0) {
	//     if(canvas){
	//       canvas.style.cursor = pointerDiv.style.cursor;
	//     }
	//   }

	//   //修改鼠标指针为默认
	//   function ChangeMouse2Default(arg0) {
	//     if(canvas){
	//       canvas.style.cursor = defaultDiv.style.cursor;
	//     }
	//   }


	// function HidePanel(t){
	//  // parent.project.clearsiteclick(t);
	// }
	function ShowJiFangInfoPanel(params) {
		parent.project.showSitelist(params);
	}

	function HideJiFangInfoPanel() {
		parent.project.hideSitelist();
	}

	//显示物体详情
	function showDetail(params) {
		parent.project.showSitelist(params);
	}
	//跳转到光合谷末端
	function goEnd(val) {

		// var GuangHeGuSiteMenuData = topJQ("#menu [data-url^='./bussiness/guangheValleyEnd/index.html']");
		// for (var i = 0; i < GuangHeGuSiteMenuData.length; i++) {
		// 	var url = topJQ(GuangHeGuSiteMenuData[i]).data("url");
		// 	var id = topJQ(GuangHeGuSiteMenuData[i]).data("id");
		// 	var title = topJQ(GuangHeGuSiteMenuData[i]).data("title");
		// 	if (url.indexOf(parent._PROJECT_ID) != -1) {
		// 		top.window.guangheguCilck = val;
		// 		top.window.openNewTab(url, id, title);
		// 		return;
		// 	}
		// }
		// alert("当前项目没有机房页面，请联系管理员添加！");
		/* var url = `./bussiness/guangheValleyEnd/index.html?
		 siteId=13&projectId=7&proname=光合谷项目&titlename=光合谷末端实况&showmenu=show&
		 titlename=光合谷末端实况&menuLeftId=61&layuiId=site-023`; */
		if (val - 0 < 4) {
			// var url = `bussiness/guangheValleyEnd/index.html?
			// siteId=13&projectId=7&proname=光合谷项目&showmenu=show&
			// titlename=%E5%85%89%E5%90%88%E8%B0%B7%E7%AB%99%E7%82%B9%E6%9C%AB%E7%AB%AF%E7%B3%BB%E7%BB%9F
			// &menuLeftId=8&v=1.03.029`
			// var id = 'site-013';
			// var title = '光合谷地热井机房';
			// top.window.guangheguCilck = val;
			// top.window.openNewTab(url, id, title);

			// 调用React方法跳转到末端站点
			top.window.clickJumpTo('/jquery/8/40');
		}
		// parent.layui.use('layer', function () {
		// 	var layer = parent.layui.layer;
		// 	layer.msg('当前项目没有机房页面，请联系管理员添加！');
		// });
	}

	// 控制设置U3d触控
	function UnityStart() {
		console.log('UnityStart');
		if (window.matchMedia("(any-pointer: coarse)").matches) {
			console.log('触摸屏');
			gameInstance.SendMessage("RecvJsMessageObject", 'GetEvent', '15000' + ', ');
		} else {
			console.log('非触摸屏');
		}
	}
</script>

</html>